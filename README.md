# Agri Assistant - WisHub

AIエージェントとのチャットを通して、特定農地の最適な再編成目標地図を自動的に作成・可視化することで、各自治体の農地集積化を推進し、日本の農業問題の解決を支援するサービス​

GithubリポジトリURL
https://github.com/kaeru61/agent-hackathon



## 1. 動作環境
python 3.10.16

## 2. セットアップ
- requirements.txtから必要なパッケージをインストールしてください。(パッケージ管理用仮想環境ツールの使用をお勧めします。)
```
pip install -r requirements.txt
```

- .envtemplateを開いてGOOGLE_API_KEYの値に自分のGeminiのAPIキーを入力してください。その後、ファイル名を.envに変更して保存してください。

- 以下のコマンドを実行してください。
```
python src/for_setup.py
```
↑必要なセットアップを行います。
```
streamlit run src/app/app.py
```
実行後、webサイトが自動で開きます。
![image](https://github.com/user-attachments/assets/c794911f-3cad-4ecb-a6f5-990124e7d315)


## 3. モックの説明

このサービスでは以下の処理を行うことができます。
- 農地のフィルタリング(〜の農業集落の農地を表示して、など)
- 農地の項目による色分け
- 農地の集約化案作成、その案におけるコスト削減推定
- 集約化案に対する1農地ごとの修正
- 収量予測シミュレーション

それぞれについて以下で説明します。

### 農地のフィルタリング
農地を項目でフィルタリングすることができます。フィルタリングできる項目は、県・市区町村、農業集落、地目(田、畑など)、などです。

※このモックでは、**茨城県水戸市の一部地域**のデータのみが含まれています。他の地域の参照はできませんのでご注意ください。
絞り込みできる農業集落の例；　筑地　内原　金谷町　飯島町　など

使用例: `農業集落が筑地の農地を見せて`
![image](https://github.com/user-attachments/assets/cc703e3d-32f6-41b8-8a2f-3ff3ff8b0832)
対応する農地に絞り込まれます

### 農地の項目による色分け
農地を項目ごとに色分けできます。

使用例: `色分けして`
![image](https://github.com/user-attachments/assets/f2a10f67-cc30-4d36-aa7f-389329530fab)
色分けの項目を選ぶことができ、凡例も表示されます

### 農地の集約化案作成、その案におけるコスト削減推定
入力されたシナリオに基づいて、集約化案を作成します。現時点ではシナリオは以下のような構成になっています。
```
田の農家数は5
畑の農家数は2
田の既存農家と面積比は以下の通り
[耕作者id] : 2
[耕作者id] : 3
[耕作者id] : 2
畑の既存農家と面積比は以下の通り
[耕作者id] : 1
```
LLMは入力されたプロンプトから最適化モデルのパラメータを設定し、実行します。実行後、集約化によるコスト削減の推定も行われます。

使用例:
```Prompt
再編成をしたいです。 以下が条件です。
田の農家数は5
畑の農家数は2
田の既存農家と面積割合は以下の通り
"2dacba93d45b0f46a25b29b985bd90e2": 3
"10aad9b486abee43973bb555cc3362c2": 2
"7db8af145bda49552f855ba395906a2f": 2
畑の既存農家と面積割合は以下の通り
"2dacba93d45b0f46a25b29b985bd90e2": 1
```
![image](https://github.com/user-attachments/assets/2b8835e7-4533-43b3-93af-1dda3d73f662)

今までの地図の右側に最適化案を表示した地図が現れます。左側のチャット欄では集約化によるコスト削減量が出力されます。
右側の地図の農地にカーソルを当てると、その農地を持つ農家が削減できる時間と燃料費が表示されます。


※使用例をカスタマイズしてこの機能を使いたい時は、耕作者idは表示中の農地に実在するidを用いてください。(用いないとエラーになります。)耕作者idは色分け機能で所有者による色分けをしている時に農地にカーソルを当てると表示されます。
耕作者idや面積比を変えて入力すると異なる最適化案が算出され出力されるので試してみてください。

### 集約化案に対する1農地ごとの修正

最適化案に対して、1農地ごとに項目を修正することができます。
修正する農地は住所で指定します。

使用例: `茨城県水戸市筑地町1502の農地の所有者を2dacba93d45b0f46a25b29b985bdgoe2に修正して`

![image](https://github.com/user-attachments/assets/e3e5d805-aa0f-4224-a290-1cee5c09e4e7)

修正を依頼した農地の色が変わって、修正できていることがわかります。

### 収量予測シミュレーション

住所と作物を指定することで、その農地での1haあたりの収量を、作物モデル(WOFOST)を用いてシミュレーションします。

使用例:`収量予測をしてください。作物は米で、住所は水戸市筑地町1524`
![image](https://github.com/user-attachments/assets/5dc9542f-1fe3-4302-bf57-b4be0d337415)

左側のチャット欄に予想収量が表示されます。
※現在シミュレーションできる作物は、米・小麦・ジャガイモに限られます。

